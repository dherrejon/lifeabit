<div ng-controller="ImagenController as imagen" ng-init="CambiarNumeroCarpeta()">

   <div class="container-fluid">
       
        <!-- Barra de Busqueda -->
        <div class="barraBuscarInformacion">
            

            <div class="row ">
               <div class="col-xs-12">

                   <div class="input-group input-group-lg" style="color: black">

                         <!-- Agregar -->
                         <span class="input-group-btn ">
                               <button type="button" class="btn botonBuscarFiltro botonAgregarBusqueda" ng-click="AbrirImagen('Agregar', null)">
                                    <span class="fa fa-plus"></span> <span class="hidden-xs"> Agregar</span>
                               </button>
                          </span>

                         <!-- Span Buscar -->
                         <div class="input-group-addon addonGroup" style="border-right-width: 0px">
                            <span class="fa fa-search"></span>
                        </div>

                          <!-- entradas -->
                          <input type="text" placeholder="Buscar por Concepto" class="form-control inputBuscar" ng-model="buscarConceptoBarra" uib-typeahead="e as (e.Nombre + e.Tema) for e in FiltroConcepto($viewValue)  | limitTo:7" typeahead-on-select="SetFiltroEtiqueta()" typeahead-select-on-blur="true" typeahead-focus-first="true" typeahead-editable="true" id="filtroConcepto" autocomplete="off" style="border-left-width: 0px"><!-- ng-blur="SetFiltroEtiquetaBlur(selected)" --> 
                          
                          <!-- limpiar texto -->
                          <span class="input-group-btn">

                             <button class="btn botonBuscarFiltro"  ng-click="buscarConceptoBarra = ''" style="border-width: 0px; border-right: 3px solid #1859b2; border-radius: 0px !important">
                                   <span class="fa fa-times-circle" ></span>
                             </button>
                          </span>
                    </div>

               </div>
            </div>

        </div>
        
        <div class="row">

            <div class="col-xs-12">
                
                
                <!-- Separador -->
                <div class="row" style="height:57px">
                   <div class="col-xs-12" >
                   </div>
                </div>
                
                <div class="row">
                    <div class="col-xs-12" style="width: 100%">

                      <!-- Separador -->
                        <div class="row" style="height:74px">
                           <div class="col-xs-12  text-center" >
                           </div>
                        </div>
                    </div>
                </div>
                
                <!-- Fitros -->
                <div class="row verFitros" ng-show="(filtro.tema.length + filtro.frecuencia.length + filtro.etiqueta.length) > 0" style="border-top: 2px  solid #79adf4;">
                   
                    <div class="btn-group pull-right">
                         
                         <!-- Limpiar filtro -->
                         <button class="btn  botonFiltrarBarraLateral text-center" style="color:black" ng-click="GetImagen()" >
                             <b ><span class="fa fa-search"></span> Buscar</b>
                         </button>
                       
                       <button class="btn  botonDetallesActividad" ng-click="CambiarVerFiltro()" >
                           <b class="fa fa-angle-double-right" ng-if="!verFiltro"></b>
                           <b class="fa fa-angle-double-up" ng-if="verFiltro"></b>
                       </button>
                    </div>
                    
                    <!-- Etiquetas -->
                    <div class="col-xs-12" ng-show="filtro.etiqueta.length && verFiltro">
                        <b> Etiquetas: </b><br>
                        <span ng-repeat="etiqueta in filtro.etiqueta | orderBy:'Nombre' track by $index">
                            <div class="btn-group" role="group" style="margin-bottom:8px">
                                <a class="btn campoAgregado" ng-click="QuitaretiquetaFiltro(etiqueta)" style="font-size:10pt">{{etiqueta.Nombre}}</a>
                                <a class="btn campoAgregadoQuitar" style="font-size:10pt" ng-click="QuitaretiquetaFiltro(etiqueta)"><span class="fa fa-times-circle"></span></a>
                            </div>
                        </span>
                    </div>

                    <!-- Temas -->
                    <div class="col-xs-12" ng-show="filtro.tema.length > 0 && verFiltro">
                        <b> Tema: </b><br>                        
                        <span ng-repeat="tema in filtro.tema | orderBy:'Tema'" >
                            <div class="btn-group" role="group" style="margin-bottom:8px">
                                <a class="btn campoAgregado" ng-click="QuitarTemaFiltro(tema)" style="font-size:10pt">{{tema.Tema}}</a>
                                <a class="btn campoAgregadoQuitar" style="font-size:10pt" ng-click="QuitarTemaFiltro(tema)"><span class="fa fa-times-circle"></span></a>
                            </div>
                        </span>
                    </div>
                    
                    <div class="col-xs-12" ng-show="(filtro.fecha.length > 0) && verFiltro">
                        <div style="height: 6px"></div>
                    </div>
                    
                    <!-- Buscar  botón -->
                    <div style="margin-right: 37px">
                        <button class="btn  botonFiltrarBarraLateral text-center pull-right" style="color:black; border-right: : 2px solid black" ng-click="LimpiarFiltro()" ng-show="verFiltro">
                            <b ><span class="fa fa-ban"></span> Limpiar</b>
                        </button>
                    </div>

                    
                </div>

                
                <div ng-include=" 'html/Control/BotonTop.html' "></div>
                
            </div>
       </div>
       
       <div style="margin-top: 10px"></div>
       
       <div ng-show="!buscar">
         
          <div class="row">
              <div class="col-xs-12">
                <br>
              </div>
          </div>
         
          <div class="row">
              <div class="col-xs-12">
                    <div class="textoUsuario text-center" style="font-size: 12pt">
                        Tienes Guardados {{NumeroImagen}} Imágenes<br>
                        <!--<span style="font-size: 12pt">-Selecciona uno o más conceptos para realizar una búsqueda-</span>-->
                    </div>
              </div>
         </div>
         <br>
          
          <div ng-repeat="folder in conceptoImagen| orderBy:'Nombre'">
               <div ng-class="{row : ($index +1)%numeroCarpeta == 0}">

                    <div class="col-xs-4 col-sm-3 col-lg-2 ">

                        <button class="btnFolder" ng-click="BuscarCarpetaConcepto(folder)">
                            <span class="fa fa-folder fa-4x" ></span> <br>
                            <b style="color: black">{{folder.Nombre}}</b><br>
                            <!--<span style="color: gray; overflow: hidden">{{folder.NumeroArchivo}} Archivo(s)</span>-->
                        </button>
                        <div style="margin-top: 15px"></div>

                    </div>     
               </div>
           </div>
           
           <div class="row">
              <div class="col-xs-12">
                <br>
              </div>
          </div>
           
       </div>
       
       <div class="row">
           
            
            
             <div ng-repeat="img in imagen" >
                <!-- Imagenes -->
                <div style="padding-left: 12px;  padding-right: 12px">
                     <div class="col-xs-4 col-sm-3 col-lg-2" style="padding-left: 3px;  padding-right: 3px">
                       <div class="imgContainer" style="cursor: pointer"  ng-click="VerImganes($index)">
                            <div class="crop center-block" >

                                <a class="btn checkImage btn-block" ng-if="img.Seleccionada" ng-click="AgregarQuitarImagenFototeca(img)">
                                    <span class="fa fa-check-circle" ></span>
                                </a>
                                 <img class="" style=" width:100%;" src="php/API/ArchivosUsuario/{{UsuarioId}}/IMG/Thumbnail/{{img.Nombre}}"/>
                             </div>
                        </div>
                        <div style="height: 15px"></div>
                     </div>
                 </div>
            </div>  
            
           <br>
           <div class="col-xs-12"  ng-show="imagen.length == 0 && buscar">
                <div class="textoUsuario">
                    Sin Resultados
                </div>   
           </div>
       </div>            
       <br>
        
    </div>   
    
     <!-------- Modales -------------->
     <div class="modal fade" id="modalApp" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-keyboard="true" data-backdrop="static">
        <br>    <br>   <br>
        <div class="modal-dialog modalPrincipal">
        
            <div class="row">
                <div class="col-xs-8 col-sm-10">
                    <!--<button class="btn close cerrarModal" ng-click="CerrarCancion()"><span aria-hidden="true">&times;</span></button>-->
                    <span class="tituloModal">{{operacion}} Imágenes</span>
                </div>
                
                <div class="col-xs-4 col-sm-2">
                    <div class="btn-group-vertical pull-right" role="group" >
                        <a class="btn botonFinModal"  ng-click="CerrarImagen()"><span class="fa fa-times"></span></a>
                        <a focus class="btn botonFinModal" id="terminarDiario" ng-click="TerminarImagen()"><span class="fa fa-check"></span></a>
                    </div>
                </div>
                
                
            </div>
            
            <form name="archivoForma">
                
                <!-- Etiqueta -->
                <div ng-include=" 'html/Control/EtiquetaControl.html' " ng-init="IniciarModal('Imagen')" ng-controller="ControlEtiquetaController as lc"></div>
                
                <div class="row">

                    <div class="col-sm-12">

                       <div  method="post" enctype="multipart/form-data">

                            <div class="form-group files">
                                <input id="cargarImagenApp" type="file" class="form-control" multiple accept="image/*" name="imagen" > <!-- onchange="angular.element(this).scope().CargarArchivo(this)" -->
                            </div>
                        </div>

                    </div>
                </div>
            
                <br>
                
                <!-- imágenes agregadas --> 
                <div class="row" >
                   <div class="col-xs-12">
                       <table  class="table table-responsive">

                            <tbody  style="cursor: pointer">

                                <tr   ng-repeat="img in nuevaImagen.ImagenSrc" ng-if="nuevaImagen.ImagenSrc.length > 0">

                                  <td class="text-center">
                                      <a class="btn operacionEvento infoCenterCell" style="font-size: 13pt;" ng-click="EtiquetarImagen(img, 'prev')">
                                        <span >
                                         <span class="fa fa-tag"> </span> <span> ({{ContarEtiquetasVisibles(img.Etiqueta)}}) </span>
                                         <span class="fa fa-comment-o"> </span> <span> ({{img.Tema.length}}) </span>
                                        </span>
                                     </a>
                                  </td>

                                  <td style="width: 100px; max-width: 100px">
                                      <div class="imgContainer" style="height:50px">
                                          <a style="overflow: hidden !important; max-height: 50px">
                                            <img class="img-responsive" style="width: 100%" src=" {{img.Src}}" ng-click="VerImganes(true, true, false, nuevaImagen.Imagen, nuevaImagen.ImagenSrc, $index, 0)"/>
                                          </a>
                                      </div>
                                    </td>

                                  <td class="hidden-xs"> <span class="infoCenterCell">{{img.name}}</span> </td>
                                    <td class="hidden-xs">  <span class="infoCenterCell">{{(img.size/1000000).toFixed(2)}} MB</span> </td>
                                  <td class="text-center">
                                      <a class="btn btnQuitarImg" ng-click="nuevaImagen.ImagenSrc.splice($index,1); nuevaImagen.ImagenTh.splice($index,1); nuevaImagen.ImagenWeb.splice($index,1);">
                                         <span class="fa fa-times-circle"></span>
                                     </a>
                                  </td>


                                </tr>

                            </tbody>

                        </table>
                   </div>
                </div>
                  
            </form>
            
            
            <br>
            <!---- botones de operacion -->
            <div class="row">
                <div class="col-xs-6">
                    <a class="btn botonFinModal btn-block" ng-click="CerrarImagen()">CANCELAR</a>
                </div>

                <div class="col-xs-6">
                    <a focus class="btn botonFinModal btn-block" ng-click="TerminarImagen()">TERMINAR</a>
                </div>
            </div>
        
        </div>
    </div>
    
    <!-- Cerrar -->
    <div class="modal fade sombraDivModal" id="cerrarImagen">
        <br>    <br>   <br>
        <div class="modal-dialog modal-sm modalPrincipal text-center">
           
            <div class="row">
                <div class="col-xs-12">
                    <span style="font-size:14pt">¿Estas seguro de salir sin guardar los cambios?</span>
                </div>
            </div>
            <br><br>
            <div class="row">
                <div class="col-xs-6">
                    <button class="btn botonFinModal" data-dismiss="modal" aria-label="Close">No</button>
                </div>
                <div class="col-xs-6">
                    <button class="btn botonFinModal" data-dismiss="modal" aria-label="Close" ng-click="ConfirmarCerrarImagen()">Si</button>
                </div>
            </div>
                        
        </div>
    </div> 

    
    <!---------- VerImagen ---------------->
    <div class="modal fade sombraDivModal" id="verImagen" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <br>    <br>   <br>
        <div class="modal-dialog modal-md modalPrincipal">
          
          <div class="row">
                <div class="col-xs-12">
                    <a class="pull-right" data-dismiss="modal" aria-label="Close"> <span class="fa fa-times changeImage">    </span></a>
                </div>
            </div>
            <br>
            
            
            <div class="row">
                <div class="col-xs-12">
                    <div class="button-group pull-right">
                        <a class="btn operacionEvento " style="font-size: 13pt;" ng-click="EtiquetarImagenEditar(imagen[iImg])">
                            <span >
                             <span class="fa fa-tag"> </span> <span> ({{imagen[iImg].NumeroEtiqueta}}) </span>
                             <span class="fa fa-comment-o"> </span> <span> ({{imagen[iImg].NumeroTema}}) </span>
                            </span>
                         </a>
                         
                         
                        <a class="btn operacionEvento " style="font-size: 13pt;" ng-click="BorrarImagen(imagen[iImg].ImagenId)">
                            <span class="textoRojo">Borrar</span>
                         </a>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-xs-12">
                    <div id="myCarousel2" class="carousel  slide">
  
                      <!-- Items -->
                      <div class="carousel-inner">
                        <div class="item" ng-class="{active: $index == iImg}" ng-repeat="img in imagen">
                            <img  class="img-responsive center-block" src="php/API/ArchivosUsuario/{{UsuarioId}}/IMG/Web/{{img.Nombre}}"/>
                        </div>
                      </div>
                      <!-- Navigation -->
                       <a class="left carousel-control"  ng-click="changeImageViewed(-1);" ng-if="imagen.length > 1">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                        </a>
                        <a class="right carousel-control"  ng-click="changeImageViewed(1);" ng-if="imagen.length > 1">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
     <!-- mensaje -->
    <div class="modal fade sombraDivModal" id="mensajeImagen">
        <br>    <br>   <br>
        <div class="modal-dialog modal-sm modalPrincipal">
           
            <div class="row">
                <div class="col-xs-12">
                    <div class="text-center textoError">
                        <span class=" fa fa-times-circle-o fa-3x"></span><br>
                        <span>¡Error!</span>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-xs-12">
                     <div ng-repeat="error in mensajeError">
                        <span>{{error}}</span>
                    </div>
                </div>
            </div>
            <br><br>
         
            <div class="row">
                <button class="btn botonModalError" data-dismiss="modal" aria-label="Close">Aceptar</button> 
            </div>

        </div>
    </div>
    
    <!-- Borrar -->
    <div class="modal fade sombraDivModal" id="borrarImagen">
        <br>    <br>   <br>
        <div class="modal-dialog modalPrincipal text-center">
           
            <div class="row">
                <div class="col-xs-12">
                    <span style="font-size:14pt">{{mensajeBorrar}}</span>
                </div>
            </div>
            <br><br>
            <div class="row">
                <div class="col-xs-6">
                    <button class="btn botonFinModal" data-dismiss="modal" aria-label="Close">No</button>
                </div>
                <div class="col-xs-6">
                    <button class="btn botonFinModal" data-dismiss="modal" aria-label="Close" ng-click="ConfirmarBorrarImagen()">Si</button>
                </div>
            </div>
                        
        </div>
    </div>
    
    
</div>
  
<!--------------- otros html -------------------->
<div ng-include=" 'html/Imagen/EtiquetaImagen.html' "></div>
<div ng-include=" 'html/Sabiduria/Administrar/Etiqueta/AgregarEtiqueta.html' "></div>
<div ng-include=" 'html/Sabiduria/Administrar/Etiqueta/EtiquetaEquivalente.html' "></div>
<div ng-include=" 'html/Control/AgregarTema.html' "></div>
  

   

   
    